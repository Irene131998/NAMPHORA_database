---
title: "Harmonised taxonomy metadata"
author: "Irene Solano"
format: html
editor: visual
execute:
  echo: true
  warning: false
  message: false
---

# Description

The NAMPHORA database compiles fossil and modern pollen records from multiple sources, including the African Pollen Database (APD: https://africanpollendatabase.ipsl.fr/#/home), Neotoma Paleoecology Database (https://www.neotomadb.org/), and direct contributions from authors. However, due to differences in taxonomic nomenclature across these sources, a taxonomic harmonisation process was implemented to ensure consistency and comparability.

The pollen taxonomical harmonisation followed these key steps:

1.  **Harmonisation of taxonomic names**

    -   Each pollen type was categorised at the most precise possible taxonomic rank (family, genus, species, or morphotype), following morphological studies and monographs.

    -   Cases where species-level identification was not possible were assigned to higher taxonomic levels.

    -   Pollen types were also cross-referenced with published harmonisation tables:

        -   Lézine *et al*. (2009)

        -   Mottl *et al*. (2021)

        -   APD taxonomy list (https://africanpollendatabase.ipsl.fr/#/taxon-dict)

    -   Synonyms and outdated classifications were updated to match current botanical taxonomy following the Global Biodiversity Information Facility (GBIF, [https://www.gbif.org](https://www.gbif.org/)) and International Plant Names Index (IPNI, <https://www.ipni.org>).

2.  **Incorporation of habit and phytogeographical affinity information**

    -   Taxa were assigned plant habit (growth form) categories following Plants of the World online website (POWO; <https://powo.science.kew.org/>) & several references.

    -   Taxa were assigned phytogeographic affinities following GBIF, POWO & several references.

    -   Phytogeographic affinities were linked to GBIF & POWO.

3.  **Final harmonisation list**

    -   The harmonised taxonomy list was compiled into *harmonised_taxonomy_list.csv*, which serves as the reference list for all pollen records compiled in the NAMPHORA database.
    -   Metadata for the *harmonised_taxonomy_list.csv* file is provided here:

```{r}
#| echo: false
#| output: false
#| message: false
# Load libraries and functions ----
source("functions.R")

library <- c("knitr", "dplyr","readr")

# Install missing packages
invisible(lapply(library, install_if_missing))

# Load the library
lapply(library, require, character.only = TRUE)

```

```{r}
#| echo: false
#| output: false
#| message: false
# Define Attributes

# Define variable names, descriptions, and units
attributes <- data.frame(
  Name = c("Palaeo_Modern", 
           "Biological_group",
           "Taxa_superior",
           "Higher_rank",
           "Order", 
           "Family",
           "Subfamily",
           "Tribe",
           "Genus", 
           "Original_taxa", 
           "Pollen_type_harmonised",
           "Taxonomical_resolution_original_type",
           "Taxonomical_resolution_harmonised_type",
           "Observations_SM", 
           "Observations_IS", 
           "Reference_taxonomy_family_order_1",
           "Reference_taxonomy_subfamily_tribe_1",
           "Reference_pollen_taxonomy_1", 
           "Reference_pollen_taxonomy_2", 
           "Reference_pollen_taxonomy_3", 
           "Reference_pollen_taxonomy_4", 
           "Fossil_Sequences", 
           "Modern_Sequences", 
           "Total_Sequences", 
           "Pollen_type_harmonised_Lezine_2009", 
           "Pollen_type_harmonised_Mottl_2020", 
           "Pollen_type_harmonised_APD",
           "Fossil_Sequences_Pollen_type_harmonised",
           "Modern_Sequences_Pollen_type_harmonised",
           "Total_Sequences_Pollen_type_harmonised"),
  
  Description = c("Indicates whether the data is from fossil (Palaeo) or modern (Modern) records", 
                  "Indicates the biological group to which the original pollen type belongs (angiosperms, invertebrates, pteridophyta, etc.)",
                  "Indicates the biological group (in more taxonomical detail) to which the original pollen type belongs (angiosperms, invertebrates, monilophya, lycophyta, etc.)",
                  "Indicates the higher rank to which the original pollen type belongs (angiosperms, rotifera, monilophyta, etc.)",
                  "Order of the original pollen type",
                  "Family of the original pollen type", 
                  "Subfamily of the original pollen type", 
                  "Tribe of the original pollen type",
                  "Genus of the original pollen type", 
                  "Original taxonomic name as recorded in the dataset",
                  "Morphological harmonisation of the pollen type", 
                  "Level of taxonomic resolution in the original type (species, genus, family, etc.)",
                  "Level of taxonomic resolution in the harmonised type (species, genus, family, etc.)",
                  "Observations on the pollen type harmonisation (by Saúl Manzano (SM))", 
                  "Observations on the pollen type harmonisation (by Irene Solano (IS))", 
                  "Reference for assignation of families and orders", 
                  "Reference for assignation of subfamilies and tribes", 
                  "Reference for pollen taxonomy", 
                  "Reference for pollen taxonomy", 
                  "Reference for pollen taxonomy", 
                  "Reference for pollen taxonomy", 
                  "Number of fossil records in which the original pollen type is present", 
                  "Number of modern records in which the original pollen type is present", 
                  "Total number of records in which the original pollen type is present", 
                  "Pollen type classification from Lézine et al. (2009)", 
                  "Pollen type classification from Mottl et al. (2020)", 
                  "Pollen type classification from APD",
                  "Number of fossil records in which the harmonised pollen type is present", 
                  "Number of modern records in which the harmonised pollen type is present",
                  "Total number of records in which the harmonised pollen type is present"),
  
  Unit = c("Categorical", 
           "Categorical", 
           "Categorical", 
           "Categorical", 
           "Categorical", 
           "Categorical", 
           "Categorical", 
           "Categorical", 
           "Categorical", 
           "Categorical", 
           "Categorical",
           "Categorical",
           "Categorical",
           "Categorical", 
           "Categorical", 
           "Reference", 
           "Reference", 
           "Reference", 
           "Reference", 
           "Reference", 
           "Reference", 
           "Count", 
           "Count", 
           "Count", 
           "Categorical", 
           "Categorical", 
           "Categorical", 
           "Count", 
           "Count", 
           "Count")
)


# Save attributes metadata as CSV
write_csv(attributes, normalizePath("../metadata/taxonomy/taxonomy_metadata.csv"))

```

# Metadata

```{r}
#| echo: false
# Display table in HTML
kable(attributes)
```

# References

1.  Lézine, A. M., Watrin, J., Vincens, A., & Hély, C. Are modern pollen data representative of West African vegetation? *Review of Palaeobotany and Palynology, 156*, 265–276. (2009).

2.  Mott, O., et al. Global acceleration in rates of vegetation change over the past 18,000 years. *Science, 372*, 860–864. (2021).
